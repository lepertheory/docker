#!/usr/bin/env bash

set -o errexit
set -o pipefail
set -o nounset

SCRIPT_NAME="$(basename      "${BASH_SOURCE[0]}")"
SCRIPT_PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
readonly SCRIPT_NAME
readonly SCRIPT_PATH

readonly PACKAGE="${1}"
readonly ARCHIVE="${2}"

cd "${LFS}"/sources

echo "Unpacking ${ARCHIVE}"
mkdir -v "${PACKAGE}"
tar --extract  --strip-components=1 --directory="${PACKAGE}" --file="${ARCHIVE}"

cd "${PACKAGE}"
echo "Building ${PACKAGE}"
CFLAGS='-Os -pipe' CXXFLAGS='-Os -pipe' "${SCRIPT_PATH}/${PACKAGE}" > ~/"${PACKAGE}"-build.log
